---
title: "Analyzing class biodiversity simulation data"
output: html_notebook
---

## Introduction
With this code we will take a look at the biodiversity indices we calculated for our sets of beads in lab.

We'll start by setting up our workspace and loading the raw data.

```{r}
rm(list = ls())
library(tidyverse)
library(here)
DF<-read.csv(here("Data","bead_simulation_2023.csv"))
```
And pull in the actual values
```{r}
Actual<-read.csv(here("Data", "index_actual_values.csv"), stringsAsFactors = T)
Actual$Simpson<-1/Actual$Simpson..inverse.

```

Now get a few variables set
```{r}
DF$Trial<-as.factor(DF$Trial)
DF$Index<-as.factor(DF$Index)
DF$Set_Number<-as.factor(DF$Set_Number)
```

Now let's get some summary statistics
```{r}
DFsummary<-DF %>% group_by(Trial, Index) %>% summarise(
  IndexAvg = mean(Value, na.rm = T),
  IndexSD = sd(Value, na.rm = T), 
  IndexSEM = IndexSD/sqrt(length(Index))
)
```
Now let's plot
Start by joining data
```{r}
MyJoin<-full_join(DF, DFsummary, by = c("Trial", "Index"))
```
Now plot full thing
```{r}
ggplot(MyJoin, aes(Index, Value))+
  geom_jitter(alpha = 0.5, color = "dark green", width = 0.05)+
  geom_point(aes(Index, IndexAvg), size = 4, color = "dark green")+
  geom_errorbar(aes(Index,ymin = IndexAvg-IndexSEM, ymax = IndexAvg+IndexSEM), color = "dark green", width = 0.25)+
  #geom_segment(aes(x = 0.5, xend = 2.5, y = 10, yend = 10), color = "red")+
  labs(title = "Species Richness")+
  facet_wrap(~Trial)
 
```




Species Richness
```{r}
ggplot()+
  geom_jitter(aes(Trial, Value), alpha = 0.5, color = "dark green", width = 0.05, data = (filter(DF, Index == "Species richness")))+
  geom_point(aes(Trial, IndexAvg), size = 4, color = "dark green", data = (filter(DFsummary, Index == "Species richness")))+
  geom_errorbar(aes(Trial,ymin = IndexAvg-IndexSEM, ymax = IndexAvg+IndexSEM), color = "dark green", width = 0.25,data = (filter(DFsummary, Index == "Species richness")))+
  geom_segment(aes(x = 0.5, xend = 2.5, y = 10, yend = 10), color = "red")+
  labs(title = "Species Richness")
 
```
Now look at Simpson's index

```{r}
ggplot()+
  geom_jitter(aes(Trial, Value), alpha = 0.5, color = "dark green", width = 0.05, data = (filter(DF, Index == "Simpson's index")))+
  geom_point(aes(Trial, IndexAvg), size = 4, color = "dark green", data = (filter(DFsummary, Index == "Simpson's index")))+
  geom_errorbar(aes(Trial,ymin = IndexAvg-IndexSEM, ymax = IndexAvg+IndexSEM), color = "dark green", width = 0.25,data = (filter(DFsummary, Index == "Simpson's index")))+
  geom_segment(aes(x = 0.5, xend = 1.5, y = 0.568, yend = 0.568), color = "red")+
  geom_segment(aes(x = 1.5, xend = 2.5, y = 0.095, yend = 0.095), color = "red")+
  labs(title = "Simpson's index")
```
Now look at the Shannon index
```{r}
ggplot()+
  geom_jitter(aes(Trial, Value), alpha = 0.5, color = "dark green", width = 0.05, data = (filter(DF, Index == "Shannon index")))+
  geom_point(aes(Trial, IndexAvg), size = 4, color = "dark green", data = (filter(DFsummary, Index == "Shannon index")))+
  geom_errorbar(aes(Trial,ymin = IndexAvg-IndexSEM, ymax = IndexAvg+IndexSEM), color = "dark green", width = 0.25,data = (filter(DFsummary, Index == "Shannon index")))+
  geom_segment(aes(x = 0.5, xend = 1.5, y = 1.10, yend = 1.10), color = "red")+
  geom_segment(aes(x = 1.5, xend = 2.5, y = 2.30, yend = 2.30), color = "red")+
  labs(title = "Shannon index")
```
And evenness

```{r}
ggplot()+
  geom_jitter(aes(Trial, Value), alpha = 0.5, color = "dark green", width = 0.05, data = (filter(DF, Index == "Evenness")))+
  geom_point(aes(Trial, IndexAvg), size = 4, color = "dark green", data = (filter(DFsummary, Index == "Evenness")))+
  geom_errorbar(aes(Trial,ymin = IndexAvg-IndexSEM, ymax = IndexAvg+IndexSEM), color = "dark green", width = 0.25,data = (filter(DFsummary, Index == "Evenness")))+
  geom_segment(aes(x = 0.5, xend = 1.5, y = 0.479, yend = 0.479), color = "red")+
  geom_segment(aes(x = 1.5, xend = 2.5, y = 1.0, yend = 1.0), color = "red")+
  labs(title = "Evenness index")
```


